<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Angular - Vietnam Map 34 Provinces</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js"></script>
    <link rel="stylesheet" href="../styles.css">
</head>

<body>
    <nav>
        <div class="nav-content">
            <a href="../" class="logo">üáªüá≥ Vietnam Map 34</a>
            <div class="nav-links">
                <a href="../">Demo</a>
                <a href="vanilla.html">Vanilla JS</a>
                <a href="reactjs.html">React</a>
                <a href="vuejs.html">Vue</a>
                <a href="angular.html" class="active">Angular</a>
            </div>
            <div class="nav-buttons">
                <a href="https://github.com/xdev-asia-labs/vietnam-map-34-provinces" class="btn btn-outline"
                    target="_blank">GitHub</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="doc-header">
            <span class="badge badge-angular">Angular</span>
            <h1>Angular Integration</h1>
            <p class="subtitle">H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng v·ªõi Angular 17+ (standalone components)</p>
        </div>

        <section>
            <h2>üì¶ Installation</h2>
            <pre><code class="language-bash">npm install @xdev-asia/vietnam-map-34-provinces highcharts</code></pre>
        </section>

        <section>
            <h2>üöÄ Basic Component</h2>
            <pre><code class="language-typescript">// vietnam-map.component.ts
import { Component, ElementRef, ViewChild, AfterViewInit, OnDestroy, Input, Output, EventEmitter } from '@angular/core';
import { createVietnamMap, VietnamMapInstance, ProvinceData } from '@xdev-asia/vietnam-map-34-provinces/vanilla';

@Component({
  selector: 'app-vietnam-map',
  standalone: true,
  template: `
    &lt;div class="map-wrapper"&gt;
      &lt;div *ngIf="loading" class="loading-overlay"&gt;Loading...&lt;/div&gt;
      &lt;div #mapContainer [style.height.px]="height"&gt;&lt;/div&gt;
    &lt;/div&gt;
  `,
  styles: [`
    .map-wrapper { position: relative; }
    .loading-overlay {
      position: absolute; inset: 0;
      display: flex; align-items: center; justify-content: center;
      background: rgba(0,0,0,0.5); color: white; z-index: 10;
    }
  `]
})
export class VietnamMapComponent implements AfterViewInit, OnDestroy {
  @ViewChild('mapContainer') mapContainer!: ElementRef;
  
  @Input() height = 600;
  @Input() drilldown = true;
  @Input() data: any[] = [];
  
  @Output() provinceClick = new EventEmitter&lt;ProvinceData&gt;();
  @Output() communeClick = new EventEmitter&lt;any&gt;();
  
  private mapInstance: VietnamMapInstance | null = null;
  loading = false;
  
  ngAfterViewInit(): void {
    this.initMap();
  }
  
  ngOnDestroy(): void {
    this.mapInstance?.destroy();
  }
  
  private initMap(): void {
    this.mapInstance = createVietnamMap(this.mapContainer.nativeElement, {
      height: this.height,
      data: this.data.length ? this.data : undefined,
      drilldown: this.drilldown ? {
        enabled: true,
        onLoading: (isLoading) => this.loading = isLoading
      } : false,
      onProvinceClick: (province) => this.provinceClick.emit(province),
      onCommuneClick: (commune) => this.communeClick.emit(commune)
    });
  }
  
  zoomToProvince(id: string): void {
    this.mapInstance?.zoomToProvince(id);
  }
  
  resetZoom(): void {
    this.mapInstance?.resetZoom();
  }
  
  drilldownTo(name: string): void {
    this.mapInstance?.drilldownTo(name);
  }
  
  drillUp(): void {
    this.mapInstance?.drillUp();
  }
}</code></pre>
        </section>

        <section>
            <h2>üìã Usage in Parent Component</h2>
            <pre><code class="language-typescript">// app.component.ts
import { Component } from '@angular/core';
import { VietnamMapComponent } from './vietnam-map.component';

@Component({
  selector: 'app-root',
  standalone: true,
  imports: [VietnamMapComponent],
  template: `
    &lt;div class="app"&gt;
      &lt;h1&gt;Vietnam Map Demo&lt;/h1&gt;
      
      &lt;app-vietnam-map
        [height]="650"
        [drilldown]="true"
        [data]="mapData"
        (provinceClick)="onProvinceClick($event)"
      &gt;&lt;/app-vietnam-map&gt;
      
      &lt;div *ngIf="selectedProvince"&gt;
        Selected: {{ selectedProvince.name }}
      &lt;/div&gt;
    &lt;/div&gt;
  `
})
export class AppComponent {
  selectedProvince: any = null;
  
  mapData = [
    { 'hc-key': 'vn-new-ha-noi', value: 5000, label: 'High traffic' },
    { 'hc-key': 'vn-new-ho-chi-minh', value: 8000, label: 'Very high' }
  ];
  
  onProvinceClick(province: any): void {
    this.selectedProvince = province;
    console.log('Clicked:', province);
  }
}</code></pre>
        </section>

        <section>
            <h2>üîß Service for Province Data</h2>
            <pre><code class="language-typescript">// province.service.ts
import { Injectable } from '@angular/core';
import { 
  NEW_34_PROVINCES, 
  getProvinceStats, 
  loadProvinceCommunes,
  ProvinceIndex 
} from '@xdev-asia/vietnam-map-34-provinces/core';

@Injectable({ providedIn: 'root' })
export class ProvinceService {
  
  getProvinces() {
    return NEW_34_PROVINCES;
  }
  
  getStats() {
    return getProvinceStats();
  }
  
  async getCommunes(provinceName: string) {
    const data = await loadProvinceCommunes(provinceName);
    return data?.features || [];
  }
  
  getProvinceById(code: number) {
    return NEW_34_PROVINCES.find(p => p.code === code);
  }
  
  getMergedProvinces() {
    return NEW_34_PROVINCES.filter(p => p.merged_from && p.merged_from.length > 1);
  }
}</code></pre>
        </section>

        <section>
            <h2>üé® Styling with Angular</h2>
            <pre><code class="language-typescript">// In component styles or global styles.scss
:host {
  --map-bg: linear-gradient(135deg, #0f172a 0%, #1e3a5f 100%);
  --map-border-radius: 1rem;
}

.map-wrapper {
  background: var(--map-bg);
  padding: 2rem;
  border-radius: var(--map-border-radius);
  
  ::ng-deep {
    .highcharts-tooltip {
      filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.3));
    }
    
    .highcharts-data-label text {
      font-family: 'Inter', sans-serif !important;
    }
  }
}</code></pre>
        </section>

        <div class="doc-nav">
            <a href="vuejs.html" class="btn btn-outline">‚Üê Vue.js</a>
            <a href="vanilla.html" class="btn btn-primary">Vanilla JS ‚Üí</a>
        </div>
    </div>

    <footer>
        <p>Made with ‚ù§Ô∏è by <a href="https://github.com/xdev-asia-labs">xdev-asia-labs</a></p>
    </footer>
</body>

</html>